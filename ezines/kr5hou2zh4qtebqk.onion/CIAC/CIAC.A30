----------------------------------------------------------------------------

              THE COMPUTER INCIDENT ADVISORY CAPABILITY

                                   

                                 CIAC

                                   

                         INFORMATION BULLETIN

----------------------------------------------------------------------------



                  Apollo Domain/OS suid_exec Problem



July 30, 1990, 1100 PST Number A-30



----------------------------------------------------------------------------

                   Critical suid_exec problem Facts



Name: suid_exec problem



Types: Apollo Domain/OS version SR10.2 and SR10.3 beta earlier than BL67



Platform: Hewlett Packard/Apollo systems



Damage: Can cause unauthorized  privileged access to the system



Workaround: Backup and remove the file suid_exec from the directories

        /etc on each node, and in each authorized area:

                <AA>/install/ri.apollo.os.v.10.2/sys5.3/etc/suid_exec

                <AA>/install/ri.apollo.os.v.10.2/bsd4.3/etc/suid_exec

                <AA>/install/ri.apollo.os.v.10.2.p/sys5.3/etc/suid_exec

                <AA>/install/ri.apollo.os.v.10.2.p/bsd4.3/etc/suid_exec



Patch: Hewlett Packard/Apollo will release an incremental software

release to this level of the Apollo Domain/OS system shortly.  This

will be available from HP/Apollo as part number 018669-A00, SR10.2.



----------------------------------------------------------------------------



The CIAC team has received information about a bug in a recent release

of the Apollo Domain/OS system released by Hewlett Packard/Apollo.

This bug can allow an intruder unauthorized privileged access to a

system.  There is a workaround for this flaw described below, and a

patch will be available directly from Hewlett Packard/Apollo in the

next incremental software release.  The following announcement was

recently released by Hewlett Packard.





  This message is to alert administrators of Domain/OS systems of a

  serious security problem in all versions of Domain/OS Release sr10.2

  and in Beta versions of sr10.3 earlier than bl67. This problem is

  NOT present in sr10.1 or earlier versions of Domain/OS. This problem

  can be referred to as APR number DE278, other APRs have been filed

  against this problem.



  There is a known flaw in the file /etc/suid_exec. This file should

  be deleted IMMEDIATELY from the /etc directories on all HP/Apollo

  nodes AND from all authorized areas on HP/Apollo networks from which

  software can be installed.



  The files that must be deleted are:

        On each node:

                //<node>/etc/suid_exec



        In each Authorized Area:



                <AA>/install/ri.apollo.os.v.10.2/sys5.3/etc/suid_exec

                <AA>/install/ri.apollo.os.v.10.2/bsd4.3/etc/suid_exec

                <AA>/install/ri.apollo.os.v.10.2.p/sys5.3/etc/suid_exec

                <AA>/install/ri.apollo.os.v.10.2.p/bsd4.3/etc/suid_exec





  You must be 'root' or 'locksmith' in order to delete these files.



  The removal of these files will resolve the security vulnerability

  immediately.



  This procedure will require that the install tool should be run with the

  -x option ( continue on error - see Installing Software with Apollo's

  Release and Installation Tools, Apollo order number 008860-A00, chapter

  4) for all subsequent installations until the replacement files have been

  obtained. The absence of these files in the authorized areas will

  generate an error message during the installation process, and, if the -x

  option is not specified when invoking the installation tool, will

  terminate the install.



  This file is normally required by the Korn Shell to run set-id Korn Shell

  scripts, but is a no-op on HP/Apollo systems since Domain/OS does NOT

  support the execution of set-id shell scripts. Its purpose is to serve as

  the 'agent' described in the manual page for the Korn Shell under

  'Execution'. An error during compilation introduced the reported

  vulnerability. The removal of this file will have no affect on the

  functionality provided by HP/Apollo systems, but will affect the

  installation procedure as mentioned in the previous paragraph.



  HP/Apollo is creating an incremental software release that will replace

  these files with the correctly compiled version of the suid_exec program.

  This incremental release will be made available to software maintenance

  customers shortly. Those users not on a HP/Apollo maintenance contract

  should be able to order the replacement files as HP/Apollo part number

  018669-A00, SR10.2 Incremental Software Release. Once installed, the

  replacement files will permit normal installation of software. They will

  NOT permit set-id shell scripts to be run on Domain/OS installations.



  The repaired file will also be available as patch_m0170 on 68000-based

  systems, and patch_p0136 on DN10000-based systems. These patches are

  scheduled to be on the August patch tape. The problem has already been

  addressed in the next release of Domain/OS.



For additional information or assistance, please contact CIAC: 



        Tom Longstaff

        (415) 423-4416 or (FTS) 543-4416

        FAX:  (415) 423-0913, (FTS) 543-0913 or (415) 422-4294



CIAC's 24-hour emergency hot-line number is (415) 971-9384.  If you

call the emergency number and there is no answer, please let the

number ring until voice mail comes on.  Please leave a voice mail

message; someone will return your call promptly.  You may also send

e-mail to:



                         ciac@tiger.llnl.gov

 

Thanks to John G. Griffith of Hewlett Packard and Paul Holbrook of the

CERT/CC team for this information.



Neither the United States Government nor the University of California

nor any of their employees, makes any warranty, expressed or implied,

or assumes any legal liability or responsibility for the accuracy,

completeness, or usefulness of any information, product, or process

disclosed, or represents that its use would not infringe privately

owned rights.  Reference herein to any specific commercial products,

process, or service by trade name, trademark manufacturer, or

otherwise, does not necessarily constitute or imply its endorsement,

recommendation, or favoring by the United States Government or the

University of California.  The views and opinions of authors expressed

herein do not necessarily state or reflect those of the United States

Government nor the University of California, and shall not be used for

advertising or product endorsement purposes.



                        CIAC BULLETINS ISSUED



SUN 386i authentication bypass vulnerability

nVIR virus alert

/dev/mem vulnerability

tftp/rwalld vulnerability

"Little Black Box" (Jerusalem) virus alert

restore/dump vulnerability

rcp/rdist vulnerability

Internet trojan horse alert

NCSA Telnet vulnerability

Columbus Day (DataCrime) virus alert

Columbus Day (DataCrime) virus alert (follow-up notice)

Internet hacker alert (notice A-1)

HEPnet/SPAN network worm alert (notice A-2)

HEPnet/SPAN network worm alert (follow-up, notice A-3)

HEPnet/SPAN network worm alert (follow-up, notice A-4)

rcp vulnerability (second vulnerability, notice A-5)

Trojan horse in Norton Utilities (notice A-6)

UNICOS vulnerability (limited distribution, notice A-7)

UNICOS problem (limited distribution, notice A-8)

WDEF virus alert (notice A-9)

PC CYBORG (AIDS) trojan horse alert (notice A-10)

Problem in the Texas Instruments D3 Process Control System  (notice A-11)

DECnet hacker attack alert (notice A-12)

Vulnerability in DECODE alias (notice A-13)

Additional information on the vulnerability in the UNIX DECODE alias  (notice A-14)

Virus information update (notice A-15)

Vulnerability in SUN sendmail program (notice A-16)

Eradicating WDEF using Disinfectant 1.5 or 1.6 (notice A-17)

Notice of availability of patch for SmarTerm 240 (notice A-18)

UNIX Internet Attack Advisory (notice A-19)

The Twelve Tricks Trojan Horse (notice A-20)

Additional information on Current UNIX Internet Attacks (notice A-21)

Logon Messages and Hacker/Cracker Attacks (notice A-22)

New Internet Attacks (notice A-23)

Password Problems with  Unisys U5000 /etc/passwd  (notice A24)

The MDEF or Garfield Virus on Macintosh Computers (notice A-25)

A New Macintosh Trojan Horse Threat--STEROID (notice A-26)

The Disk Killer (Ogre) Virus on MS DOS Computers (notice A-27)

The Stoned (Marijuana or New Zealand) Virus on MS DOS Computers (notice A-28)

The 4096 (4k, Stealth, IDF, etc.) Virus on MS DOS Computers (notice A-29)

Apollo Domain/OS suid_exec Problem (notice A-30)




